{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\nconst PIXABAY_API_KEY = '50537281-d9f964856e12bb960f966723f';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page) {\n  const response = await axios.get('', {\n    params: {\n      key: PIXABAY_API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: 15,\n      page: page,\n    },\n  });\n  return response.data;\n}\n","'use strict';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet galleryLB;\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nexport function createGallery(images) {\n  const listHTML = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n      <img\n        class=\"gallery-image\"\n        src=\"${webformatURL}\"\n        alt=\"${tags}\"\n      />\n    </a>\n    <div class=\"image-captions\">\n        <p class=\"caption-value\">\n          <b class=\"caption-header\">Likes</b>\n          ${likes}\n        </p>\n        <p class=\"caption-value\">\n          <b class=\"caption-header\">Views</b>\n          ${views}\n        </p>\n        <p class=\"caption-value\">\n          <b class=\"caption-header\">Comments</b>\n          ${comments}\n        </p>\n        <p class=\"caption-value\">\n          <b class=\"caption-header\">Downloads</b>\n          ${downloads}\n        </p>\n    </div>\n  </li>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', listHTML);\n\n  reBuildGallery();\n}\n\nfunction reBuildGallery() {\n  if (!galleryLB) {\n    galleryLB = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionPosition: 'bottom',\n      captionDelay: 250,\n      captionsData: 'alt',\n    });\n  } else {\n    galleryLB.refresh();\n  }\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n  reBuildGallery();\n}\n\nexport function showLoader() {\n  loader.style.display = 'block';\n}\n\nexport function hideLoader() {\n  loader.style.display = 'none';\n}\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.style.display = 'block';\n}\n\nexport function hideLoadMoreButton() {\n  loadMoreBtn.style.display = 'none';\n}\n\nexport function scrollAfterNewImages() {\n  const firstCard = document.querySelector('.gallery .gallery-item');\n\n  if (firstCard) {\n    const cardHeight = firstCard.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getImagesByQuery } from './js/pixabay-api';\n\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  scrollAfterNewImages,\n} from './js/render-functions';\n\nconst queryForm = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet page;\nlet totalPages = 0;\nlet userQuery = '';\n\niziToast.settings({\n  position: 'topRight',\n});\n\nconst getImagesInitQuery = async () => {\n  try {\n    const { hits, totalHits } = await getImagesByQuery(userQuery, page);\n    totalPages = Math.ceil(totalHits / 15);\n\n    if (hits.length > 0) {\n      createGallery(hits);\n\n      if (page < totalPages) {\n        showLoadMoreButton();\n      }\n\n      page++;\n\n      if (page > totalPages) {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n    } else {\n      clearGallery();\n      hideLoadMoreButton();\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query.Please try again!',\n      });\n    }\n  } catch (error) {\n    hideLoadMoreButton();\n    iziToast.error({\n      title: 'Error',\n      message: 'Error loading images from the server!',\n    });\n  } finally {\n    hideLoader();\n    queryForm.reset();\n  }\n};\n\nconst getImagesAppendQuery = async () => {\n  try {\n    const { hits, totalHits } = await getImagesByQuery(userQuery, page);\n    totalPages = Math.ceil(totalHits / 15);\n\n    if (hits.length > 0) {\n      createGallery(hits);\n\n      scrollAfterNewImages();\n\n      if (page < totalPages) {\n        showLoadMoreButton();\n      }\n\n      page++;\n\n      if (page > totalPages) {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n    }\n  } catch (error) {\n    hideLoadMoreButton();\n    iziToast.error({\n      title: 'Error',\n      message: 'Error loading images from the server!',\n    });\n  } finally {\n    hideLoader();\n  }\n};\n\nqueryForm.addEventListener('submit', event => {\n  event.preventDefault();\n  userQuery = event.currentTarget.elements['search-text'].value.trim();\n\n  clearGallery();\n  showLoader();\n\n  if (userQuery === '') {\n    event.currentTarget.elements['search-text'].value = '';\n    iziToast.error({\n      title: 'Error',\n      message: 'Your query is empty, enter the query text in search field!',\n    });\n    hideLoader();\n    hideLoadMoreButton();\n    return;\n  }\n\n  page = 1;\n\n  getImagesInitQuery();\n});\n\nloadMoreBtn.addEventListener('click', event => {\n  hideLoadMoreButton();\n  showLoader();\n\n  getImagesAppendQuery();\n});\n"],"names":["PIXABAY_API_KEY","axios","getImagesByQuery","query","page","galleryLB","gallery","loader","loadMoreBtn","createGallery","images","listHTML","webformatURL","largeImageURL","tags","likes","views","comments","downloads","reBuildGallery","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","scrollAfterNewImages","firstCard","cardHeight","queryForm","totalPages","userQuery","iziToast","getImagesInitQuery","hits","totalHits","getImagesAppendQuery","event"],"mappings":"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"}